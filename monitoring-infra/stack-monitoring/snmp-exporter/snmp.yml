auths:
  public_v1:
    community: public
    security_level: noAuthNoPriv
    auth_protocol: MD5
    priv_protocol: DES
    version: 1
  public_v2:
    community: public
    security_level: noAuthNoPriv
    auth_protocol: MD5
    priv_protocol: DES
    version: 2
  monitoring_ro_v2:
    version: 2
    community: MONITORING_RO
modules:
  synology_safe:
    max_repetitions: 25
    retries: 5
    timeout: 20s
    walk:
      # Synology (DSM) : base + storage/health
      - 1.3.6.1.2.1.1         # sys (sysDescr etc.) -> utile pour valider vite
      - 1.3.6.1.4.1.6574.1       # system
      - 1.3.6.1.4.1.6574.2       # disks
      - 1.3.6.1.4.1.6574.3       # RAID / storage
      - 1.3.6.1.4.1.6574        # Synology private MIB (déjà chez toi)
      - 1.3.6.1.2.1.25      # HOST-RESOURCES-MIB (CPU, storage, process…)
      - 1.3.6.1.4.1.2021      # UCD-SNMP-MIB (load avg, mémoire…)
      - 1.3.6.1.2.1.1      # system (sysDescr, sysUpTime… utile)
      # CPU per-core
      - 1.3.6.1.2.1.25.3.3.1.2

      # Load average
      - 1.3.6.1.4.1.2021.10

      # Memory
      - 1.3.6.1.4.1.2021.4

      # Network
      - 1.3.6.1.2.1.2      # IF-MIB ifTable
      - 1.3.6.1.2.1.31     # IF-MIB ifXTable (ifName + 64-bit counters)
      - 1.3.6.1.2.1.4.20   # IP-MIB ipAddrTable (IPv4 -> optionnel)

    metrics:
      # --- CPU per core (HOST-RESOURCES-MIB) ---
      - name: hrProcessorLoad
        oid: 1.3.6.1.2.1.25.3.3.1.2
        type: gauge
        help: "CPU load per core (0-100)"
        indexes:
          - labelname: hrDeviceIndex
            type: gauge

      # --- Load average (UCD-SNMP-MIB) ---
      # Note: laLoadInt est souvent *100 (ex: 902 => 9.02). On corrigera dans Grafana/PromQL.
      - name: laLoadInt
        oid: 1.3.6.1.4.1.2021.10.1.5
        type: gauge
        help: "Load average * 100 (1,5,15min) - divide by 100 in queries"
        indexes:
          - labelname: laIndex
            type: gauge
        lookups:
          - labels: [laIndex]
            labelname: interval
            oid: 1.3.6.1.4.1.2021.10.1.2
            type: DisplayString

      # --- Memory (UCD-SNMP-MIB, usually kB) ---
      - name: memTotalReal_kb
        oid: 1.3.6.1.4.1.2021.4.5.0
        type: gauge
        help: "Total real memory (kB)"
      - name: memAvailReal_kb
        oid: 1.3.6.1.4.1.2021.4.6.0
        type: gauge
        help: "Available real memory (kB)"
      - name: memBuffer_kb
        oid: 1.3.6.1.4.1.2021.4.14.0
        type: gauge
        help: "Memory buffers (kB)"
      - name: memCached_kb
        oid: 1.3.6.1.4.1.2021.4.15.0
        type: gauge
        help: "Memory cached (kB)"
      - name: memTotalSwap_kb
        oid: 1.3.6.1.4.1.2021.4.3.0
        type: gauge
        help: "Total swap (kB)"
      - name: memAvailSwap_kb
        oid: 1.3.6.1.4.1.2021.4.4.0
        type: gauge
        help: "Available swap (kB)"
      # =========================
      # Synology DISKS (6574.2)
      # =========================
      - name: syno_disk_status
        oid: 1.3.6.1.4.1.6574.2.1.1.5
        type: gauge
        help: "Synology disk status (1=normal, others=warn/crit depending on DSM)"
        indexes:
          - labelname: diskIndex
            type: gauge
        lookups:
          - labels: [diskIndex]
            labelname: diskName
            oid: 1.3.6.1.4.1.6574.2.1.1.2
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskModel
            oid: 1.3.6.1.4.1.6574.2.1.1.3
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskType
            oid: 1.3.6.1.4.1.6574.2.1.1.4
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskRole
            oid: 1.3.6.1.4.1.6574.2.1.1.7
            type: DisplayString

      - name: syno_disk_temperature_c
        oid: 1.3.6.1.4.1.6574.2.1.1.6
        type: gauge
        help: "Synology disk temperature (Celsius)"
        indexes:
          - labelname: diskIndex
            type: gauge
        lookups:
          - labels: [diskIndex]
            labelname: diskName
            oid: 1.3.6.1.4.1.6574.2.1.1.2
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskModel
            oid: 1.3.6.1.4.1.6574.2.1.1.3
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskType
            oid: 1.3.6.1.4.1.6574.2.1.1.4
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskRole
            oid: 1.3.6.1.4.1.6574.2.1.1.7
            type: DisplayString

      - name: syno_disk_smart_health
        oid: 1.3.6.1.4.1.6574.2.1.1.13
        type: gauge
        help: "Synology SMART health (1=normal; DSM dependent)"
        indexes:
          - labelname: diskIndex
            type: gauge
        lookups:
          - labels: [diskIndex]
            labelname: diskName
            oid: 1.3.6.1.4.1.6574.2.1.1.2
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskModel
            oid: 1.3.6.1.4.1.6574.2.1.1.3
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskType
            oid: 1.3.6.1.4.1.6574.2.1.1.4
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskRole
            oid: 1.3.6.1.4.1.6574.2.1.1.7
            type: DisplayString

      - name: syno_disk_remaining_life_percent
        oid: 1.3.6.1.4.1.6574.2.1.1.11
        type: gauge
        help: "Synology disk remaining life (%) (SSD cache often, -1 means N/A)"
        indexes:
          - labelname: diskIndex
            type: gauge
        lookups:
          - labels: [diskIndex]
            labelname: diskName
            oid: 1.3.6.1.4.1.6574.2.1.1.2
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskModel
            oid: 1.3.6.1.4.1.6574.2.1.1.3
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskType
            oid: 1.3.6.1.4.1.6574.2.1.1.4
            type: DisplayString
          - labels: [diskIndex]
            labelname: diskRole
            oid: 1.3.6.1.4.1.6574.2.1.1.7
            type: DisplayString

      # =========================
      # Synology VOLUME/POOL (6574.3)
      # =========================
      - name: syno_storage_status
        oid: 1.3.6.1.4.1.6574.3.1.1.3
        type: gauge
        help: "Synology storage status (1=normal; DSM dependent)"
        indexes:
          - labelname: storageIndex
            type: gauge
        lookups:
          - labels: [storageIndex]
            labelname: storageName
            oid: 1.3.6.1.4.1.6574.3.1.1.2
            type: DisplayString

      - name: syno_storage_free_bytes
        oid: 1.3.6.1.4.1.6574.3.1.1.4
        type: counter
        help: "Synology storage free bytes"
        indexes:
          - labelname: storageIndex
            type: gauge
        lookups:
          - labels: [storageIndex]
            labelname: storageName
            oid: 1.3.6.1.4.1.6574.3.1.1.2
            type: DisplayString

      - name: syno_storage_total_bytes
        oid: 1.3.6.1.4.1.6574.3.1.1.5
        type: counter
        help: "Synology storage total bytes"
        indexes:
          - labelname: storageIndex
            type: gauge
        lookups:
          - labels: [storageIndex]
            labelname: storageName
            oid: 1.3.6.1.4.1.6574.3.1.1.2
            type: DisplayString
# --- Network interfaces (IF-MIB / ifXTable) ---

      - name: ifOperStatus
        oid: 1.3.6.1.2.1.2.2.1.8
        type: gauge
        help: "Interface operational status (1=up, 2=down)"
        indexes:
          - labelname: ifIndex
            type: gauge
        lookups:
          - labels: [ifIndex]
            labelname: ifName
            oid: 1.3.6.1.2.1.31.1.1.1.1
            type: DisplayString

      - name: ifAdminStatus
        oid: 1.3.6.1.2.1.2.2.1.7
        type: gauge
        help: "Interface admin status (1=up, 2=down)"
        indexes:
          - labelname: ifIndex
            type: gauge

      - name: ifMtu
        oid: 1.3.6.1.2.1.2.2.1.4
        type: gauge
        help: "Interface MTU"
        indexes:
          - labelname: ifIndex
            type: gauge

      - name: ifHighSpeedMbps
        oid: 1.3.6.1.2.1.31.1.1.1.15
        type: gauge
        help: "Interface speed in Mbps"
        indexes:
          - labelname: ifIndex
            type: gauge

      # --- Traffic (64-bit counters) ---
      - name: ifHCInOctets
        oid: 1.3.6.1.2.1.31.1.1.1.6
        type: counter
        help: "Interface inbound traffic (bytes)"
        indexes:
          - labelname: ifIndex
            type: gauge

      - name: ifHCOutOctets
        oid: 1.3.6.1.2.1.31.1.1.1.10
        type: counter
        help: "Interface outbound traffic (bytes)"
        indexes:
          - labelname: ifIndex
            type: gauge

  esxi_v2:
    timeout: 10s
    retries: 3
    walk:
      - 1.3.6.1.2.1.1              # sys
      - 1.3.6.1.2.1.2              # ifTable
      - 1.3.6.1.2.1.31             # ifXTable
      - 1.3.6.1.4.1.6876.2.1.1     # VM table
      - 1.3.6.1.4.1.6876.3         # host + HBA
      - 1.3.6.1.4.1.6876.4.20      # health-ish
